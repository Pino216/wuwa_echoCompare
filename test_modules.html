<!DOCTYPE html>
<html>
<head><meta>
    <title>模块测试</title>
</head>
<body>
    <h1>模块加载测试</h1>
    <div id="output"></div>
    
    <script src="js/constants.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/damageTypes.js"></script>
    <script src="js/buffManager.js"></script>
    <script src="js/sequenceManager.js"></script>
    <script src="js/calculator.js"></script>
    <script src="js/staticBonus.js"></script>
    <script src="js/echoManager.js"></script>
    <script src="js/storage.js"></script>
    
    <script>
        let output = document.getElementById('output');
        let tests = [];
        
        // 测试1: 检查全局变量
        tests.push(() => {
            if (typeof SUBSTAT_DATA !== 'undefined') {
                return '✅ SUBSTAT_DATA 已定义';
            } else {
                return '❌ SUBSTAT_DATA 未定义';
            }
        });
        
        tests.push(() => {
            if (typeof DAMAGE_TYPES !== 'undefined') {
                return '✅ DAMAGE_TYPES 已定义';
            } else {
                return '❌ DAMAGE_TYPES 未定义';
            }
        });
        
        tests.push(() => {
            if (typeof debouncedCalculate !== 'undefined') {
                return '✅ debouncedCalculate 已定义';
            } else {
                return '❌ debouncedCalculate 未定义';
            }
        });
        
        tests.push(() => {
            if (typeof addStaticBonus !== 'undefined') {
                return '✅ addStaticBonus 已定义';
            } else {
                return '❌ addStaticBonus 未定义';
            }
        });
        
        tests.push(() => {
            if (typeof initEchoSelects !== 'undefined') {
                return '✅ initEchoSelects 已定义';
            } else {
                return '❌ initEchoSelects 未定义';
            }
        });
        
        tests.push(() => {
            if (typeof calculate !== 'undefined') {
                return '✅ calculate 已定义';
            } else {
                return '❌ calculate 未定义';
            }
        });
        
        tests.push(() => {
            if (typeof autoLoadLastConfig !== 'undefined') {
                return '✅ autoLoadLastConfig 已定义';
            } else {
                return '❌ autoLoadLastConfig 未定义';
            }
        });
        
        tests.push(() => {
            if (typeof resetToDefaults !== 'undefined') {
                return '✅ resetToDefaults 已定义';
            } else {
                return '❌ resetToDefaults 未定义';
            }
        });
        
        // 运行测试
        let results = [];
        for (let test of tests) {
            try {
                results.push(test());
            } catch (e) {
                results.push('❌ 测试失败: ' + e.message);
            }
        }
        
        output.innerHTML = '<h2>测试结果:</h2><ul>' + results.map(r => `<li>${r}</li>`).join('') + '</ul>';
        
        // 检查是否有错误
        window.addEventListener('error', function(e) {
            output.innerHTML += '<h3 style="color:red;">JavaScript 错误:</h3><p>' + e.message + '</p>';
        });
    </script>
</body>
</html>